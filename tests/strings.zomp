
// (type cstring (ptr char))

// (type string
//   (int length)
//  ((ptr char) chars)
//   )
// (type pstring (ptr string))

// (func int length ((cstring s)) (
//   (var (ptr char) ptr s)
//   (var int count -1)

//   (label start)
//   (var char c (load ptr))

//   (assign ptr (ptradd ptr 1))
//   (assign count (int.add count 1))
//   (var bool b (char.equal c '\0'))
//   (branch b end start)
  
//   (label end)
  
//   (ret count)
//   ))

// (func (ptr string) makestring ((cstring cstr)) (
//   (var (ptr string) pstr (malloc string))
//   (store (fieldptr pstr length) (length cstr))
//   (store (fieldptr pstr chars) cstr)
//   (ret pstr)
//   ))

(var cstring text "this be text\n")

(func (ptr char) gettext () (seq
  (text)
  ))

(func void printstr ((pstring str)) (
  (printString (getField str chars))
  ))
  
(func int main () (seq
  (var char c 'x')
  (printChar c)
  (printNewline)
  (printString (gettext))
  (printInt (length text)) (println)
  (var pstring left (newString 40 '-'))
  (printstr left)
  (var pstring right (newString 40 '='))
  (printstr right)
  (println)
  (var pstring hline (append right left))
  (printstr hline)
  (println)
  111
  ))
  
